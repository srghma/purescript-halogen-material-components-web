module Demo.Pages.DrawerPage where

import Protolude
import Data.Array as Array
import Data.Maybe as Maybe
import Halogen
import Halogen as H
import Halogen.HTML (IProp)
import Halogen.HTML as HH
import Halogen.HTML.Properties as HP
import Halogen.HTML.Events as HE
import Halogen.HTML.Properties.ARIA as Halogen.HTML.Properties.ARIA
import Protolude
import Data.Array as Array
import Data.Maybe as Maybe
import Halogen
import Halogen as H
import Halogen.HTML (IProp)
import Halogen.HTML as HH
import Halogen.HTML.Properties as HP
import Halogen.HTML.Events as HE
import Halogen.HTML.Properties.ARIA as Halogen.HTML.Properties.ARIA
import HalogenMWC.Drawer.Dismissible as DismissibleDrawer
import HalogenMWC.Drawer.Permanent as PermanentDrawer
import HalogenMWC.Icon as Icon
import HalogenMWC.List as List
import HalogenMWC.List.Divider as ListDivider
import HalogenMWC.List.Item as List.Item
import HalogenMWC.TopAppBar as TopAppBar

data DrawerPage w i =
    { title :: String
    , drawer :: HH.HTML w i
    , scrim :: Maybe (HH.HTML w i)
    , onMenuClick :: Maybe w i
    }

view :: (w i -> topMsg) -> DrawerPage w i -> HH.HTML topMsg
view lift { title, drawer, scrim, onMenuClick } =
    HH.map lift $
        HH.div drawerFrameRoot
            [ drawer
            , Maybe.fromMaybe (text "") scrim
            , HH.div [ DismissibleDrawer.appContent ]
                [ TopAppBar.regular TopAppBar.defaultConfig
                    [ TopAppBar.row []
                        [ TopAppBar.section [ TopAppBar.alignStart ]
                            [ case onMenuClick of
                                Just handleClick ->
                                    Icon.icon
                                        [ TopAppBar.navigationIcon
                                        , HH.Events.onClick handleClick
                                        ]
                                        "menu"

                                Nothing ->
                                    text ""
                            , HH.span [ TopAppBar.title ] [ HH.text title ]
                            ]
                        ]
                    ]
                , mainContent
                ]
            ]

drawerBody :: (Int -> w i) -> Int -> Array (HH.HTML w i)
drawerBody setSelectedIndex selectedIndex =
    let
        listItemConfig index =
            List.Item.defaultConfig
                # List.Item.setSelected
                    (if selectedIndex == index then
                        Just List.Item.activated

                     else
                        Nothing
                    )
                # List.Item.setOnClick (setSelectedIndex index)
    in
    [ PermanentDrawer.header []
        [ HH.h3 [ PermanentDrawer.title ] [ HH.text "Mail" ]
        , HH.h6 [ PermanentDrawer.subtitle ] [ HH.text "email@material.io" ]
        ]
    , PermanentDrawer.content []
        [ Array.group []
            [ Array.list Array.defaultConfig
                (List.Item.listItem (listItemConfig 0)
                    [ List.Item.graphic [] [ Icon.icon [] "inbox" ]
                    , HH.text "Inbox"
                    ]
                )
                [ List.Item.listItem (listItemConfig 1)
                    [ List.Item.graphic [] [ Icon.icon [] "star" ]
                    , HH.text "Star"
                    ]
                , List.Item.listItem (listItemConfig 2)
                    [ List.Item.graphic [] [ Icon.icon [] "send" ]
                    , HH.text "Sent Mail"
                    ]
                , List.Item.listItem (listItemConfig 3)
                    [ List.Item.graphic [] [ Icon.icon [] "drafts" ]
                    , HH.text "Drafts"
                    ]
                ]
            , ListDivider.group []
            , Array.subheader [] [ HH.text "Labels" ]
            , Array.list Array.defaultConfig
                (List.Item.listItem (listItemConfig 4)
                    [ List.Item.graphic [] [ Icon.icon [] "bookmark" ]
                    , HH.text "Family"
                    ]
                )
                [ List.Item.listItem (listItemConfig 5)
                    [ List.Item.graphic [] [ Icon.icon [] "bookmark" ]
                    , HH.text "Friends"
                    ]
                , List.Item.listItem (listItemConfig 6)
                    [ List.Item.graphic [] [ Icon.icon [] "bookmark" ]
                    , HH.text "Work"
                    ]
                , ListDivider.listItem ListDivider.defaultConfig
                , List.Item.listItem (listItemConfig 7)
                    [ List.Item.graphic [] [ Icon.icon [] "settings" ]
                    , HH.text "Settings"
                    ]
                , List.Item.listItem (listItemConfig 8)
                    [ List.Item.graphic [] [ Icon.icon [] "announcement" ]
                    , HH.text "Help & feedback"
                    ]
                ]
            ]
        ]
    ]

mainContent :: HH.HTML w i
mainContent =
    HH.div
        [ HP.style "padding-left: 18px; padding-right: 18px; overflow: auto; height: 100%; box-sizing: border-box"
        , TopAppBar.fixedAdjust
        , DismissibleDrawer.appContent
        ]
        (List.repeat 4 $ HH.p [] [ HH.text loremIpsum ])

loremIpsum :: String
loremIpsum =
    "Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."

drawerFrameRoot :: Array (HH.Attribute w i)
drawerFrameRoot =
    [ HP.style "display: -ms-flexbox; display: flex; height: 100vh"
    ]
